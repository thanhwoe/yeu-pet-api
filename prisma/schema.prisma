generator client {
  provider     = "prisma-client"
  output       = "../src/generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

model account_verifications {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  account_id  String    @unique @db.Uuid
  is_verified Boolean?  @default(false)
  token       String?
  expires_at  DateTime? @db.Timestamptz(6)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  accounts    accounts  @relation(fields: [account_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_account_verifications_account_id")

  @@index([account_id], map: "idx_account_verifications_account_id")
}

model accounts {
  id                      String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email                   String?                @unique @db.VarChar(255)
  first_name              String                 @db.VarChar(255)
  last_name               String                 @db.VarChar(255)
  password_hash           String                 @db.VarChar(255)
  phone                   String                 @unique @db.VarChar(20)
  avatar_url              String?
  role                    user_role              @default(user)
  onboarding_completed    Boolean                @default(false)
  subscription            subscription_tier      @default(free)
  subscription_expires_at DateTime?              @db.Timestamptz(6)
  is_active               Boolean?               @default(true)
  last_sign_in_at         DateTime?              @db.Timestamptz(6)
  created_at              DateTime?              @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?              @default(now()) @db.Timestamptz(6)
  account_verifications   account_verifications?
  refresh_tokens          refresh_tokens?

  @@index([email], map: "idx_accounts_email")
  @@index([phone], map: "idx_accounts_phone")
}

model refresh_tokens {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  account_id String    @unique @db.Uuid
  token_hash String
  expires_at DateTime  @db.Timestamptz(6)
  revoked_at DateTime? @db.Timestamptz(6)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamptz(6)
  accounts   accounts  @relation(fields: [account_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_refresh_tokens_account_id")

  @@index([token_hash], map: "idx_refresh_tokens_token_hash")
}

enum subscription_tier {
  free
  premium
}

enum user_role {
  user
  admin
}
